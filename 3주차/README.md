# 3주차 - 네트워킹 서비스 

##### [목차]

1. AWS VPC란?
2. 기본 네트워크 개념
3. VPC 리소스
4. [실습 과제 3-1] 퍼블릭 서브넷 VPC 구성
5. [실습 과제 3-2] 프라이빗 서브넷 VPC 구성

##### [요약]

- AWS VPC는 독립된 가상의 클라우드 네트워크
- AWS VPC에 퍼블릭&프라이빗 서브넷을 직접 생성 및 차이점 확인

<hr>

### [1. AWS VPC 란?]

- VPC는 Virtual Private Cloud의 약자로 AWS 클라우드 내 논리적으로 독립된 섹션을 제공하여, 사용자가 정의한 가상 네트워크 상에서 다양한 AWS 리소스를 실행할 수 있게 지원한다.  => 독립된 가상의 클라우드 네트워크

- 사용자는 VPC 내에 IP대역, 인터페이스, 서브넷, 라우팅 테이블, 인터넷 게이트웨이, 보안 그룹, 네트워크 ACL 등을 생성하고 제어할 수 있다. 

### [2. 기본 네트워크 개념]

- #### OSI 7 레이어, TCP/IP 모델

- #### IP Address

  - 공인 IP : 전 세계 유일한 주소, 인터넷

    > AWS Public IP(EC2 중시 후 시작 시 Public IP 변경됨) => AWS Elastic IP(고정된 탄력적 IP, 할당 받은 후 미사용 시 과금)

  - 사설 IP : 맘껏 사용, 인터넷 사용 시 NAT = Fixed

  - IP 통신

    - 동일 네트워크 내부 : 그냥 가능(ARP/MAC)
    - 다른 네트워크 : **Gateway** 필요

  - NAT(Network Address Translation) : 네트워크 주소(IP) 변환

- TCP와 UDP, 포트번호(0~65535)

- DHCP, DNS

- 라우터, 라우팅, 라우팅 테이블

### [3. VPC 리소스]

1. ##### 서브넷

   > 서브넷(subnet)의 일반적인 개념은 **네트워크 영역을 부분적으로 나눈 망**으로 정의할 수 있다. 
   >
   > + 서브넷의 IP대역은 VPC의 IP대역에 속해 있어야 하며, 서브넷은 1개의 AZ에 종속되어야 한다. 
   >
   > + AWS VPC 내부의 서브넷에 할당할 수 있는 IP대역에서 미리 예약되어 있는 IP 주소가 있다. 
   >
   >   ```
   >   예를 들어 VPC A(10.0.0.0/16) 내부의 서브넷에 할당할 IP대역이 10.0.0.0/24이라면 10.0.0.0~10.0.0.255 중에서
   >   첫번째 주소: 10.0.0.0 - 네트워크 주소
   >   두번째 주소: 10.0.0.1 - AWS VPC 가상 라우터 주소
   >   세번째 주소: 10.0.0.2 - AWS DNS 서버 주소 
   >   네번째 주소: 10.0.0.3 - 향후 새로운 기능에 활용할 주소
   >   마지막 주소: 10.0.0.255 - 네트워크 브로드캐스트 주소
   >   VPC 내 여러 서브넷이 존재할 경우 첫번째 서브넷의 세번째 주소를 DNS 서버 주소로 사용합니다. 
   >   나머지 서브넷의 세번째 주소는 AWS에서 예약되어 있습니다.
   >   ```

   - 퍼블릭 서브넷
     공인 네트워크의 개념으로 **외부 인터넷 구간과 직접적으로 통신**을 할 수 있는 공공 네트워크 
   - 프라이빗 서브넷
     사설 네트워크의 개념으로 외부 인터넷 구간과 직접적인 통신을 할 수 없는 **폐쇄적인** 네트워크 

2. ##### 가상 라우터와 라우팅 테이블

   - VPC를 생성하면 자동으로 **가상 라우터**가 생성된다. 이 가상 라우터는 **라우팅 테이블**을 가지고 있어서 목적지 네트워크로 **라우팅**한다. 
   - 가상 라우터에서는 서브넷 별로 라우팅 테이블을 매핑시켜줄 수 있다. 

3. ##### 인터넷 게이트웨이

   - 인터넷 게이트웨이는 VPC와 인터넷 간의 논리적인 연결 (= VPC에서 인터넷 구간으로 나가는 관문)
   - VPC당 1개의 인터넷 게이트웨이만 생성 가능

4. ##### NAT 게이트웨이

   - NAT 게이트웨이 또한 인터넷 게이트웨이처럼 외부 인터넷 구간과 연결하는 관문의 역할 
   - 차이점 
     - NAT 게이트웨이 :  프라이빗 IP를 퍼블릭 IP로 변환하여 통신을 도와줌, 프라이빗 서브넷에서 외부 인터넷 통신은 가능하지만 반대는 불가능
     - 인터넷 게이트웨이 : 퍼블릭 서브넷의 외부 인터넷 구간을 연결

5. ##### 보안 그룹와 네트워크 ACL

   - VPC는 인스턴스 레벨과 서브넷 레벨 상에서 대상을 필터링할 수 있는 보안 기술을 가짐 => 인바운드 및 아웃바운드되는 데이터에 대해 허용 규칙과 거부 규칙을 수립하여, 원하는 데이터만 수용할 수 있게 필터링함
   - 보안 그룹 : 인스턴스 레벨에서의 보안 기술
   - 네트워크 ACL : 서브넷 레벨에서의 보안 기술 

### [4.(실습 과제 3-1) 퍼블릭 서브넷 VPC 구성]

- 실습 내용) 퍼블릭 서브넷 VPC 실습 환경을 단계별로 구성하여, 단일 퍼블릭 서브넷에 속한 EC2 인스턴스가 외부 인터넷 구간으로 통신하는 실습 

① 퍼블릭 서브넷의 퍼블릭 EC2 인스턴스가 외부 인터넷 구간과 통신하기 위해 데이터를 가상 라우터로 전달합니다. (퍼블릭 IP 사용)

② 가상 라우터는 퍼블릭 라우팅 테이블을 참고하여 인터넷 게이트웨이로 향하는 라우팅 경로를 확인합니다.

③ 가상 라우터는 인터넷 게이트웨이로 데이터를 전달하고 인터넷 구간으로 넘어갑니다.

④ 인터넷 구간을 통해 결국 사용자에게 전달합니다.

### [5.(실습 과제 3-2) 프라이빗 서브넷 VPC 구성]

실습 내용) 퍼블릿 서브넷 VPC에 이어서 프라이빗 서브넷과 NAT 게이트웨이를 생성하여 외부 인터넷 구간과 통신되는 실습